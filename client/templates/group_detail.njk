{%extends "group_layout.njk"%}
{%block css%}
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/trix/1.2.0/trix.css"/>
{%endblock%} 
{%from "partials/form_messages.njk" import messages%}
{%block layout%}
	<div class="mt-4">
		<form data-controller="group-post-creator" data-group-post-creator-group-id="{{group.id}}" class="p-4 border border-pink-100" data-action="group-post-creator#post" data-target="group-post-creator.form">
			<div class="my-2">
				{{messages("create")}}
			</div>
			<div class="" data-controller="trix">
				<input type="hidden" id="new-post-body" value="{{event.description}}" name="body" />
				<label class="font-bold cursor-pointer sr-only" for="editor">Create a post</label>
				<trix-toolbar id="toolbar" class="purple-button"></trix-toolbar>
				<trix-editor input="new-post-body" id="editor" data-target="trix.editor group-post-creator.trix" toolbar="toolbar" placeholder="Write your post"></trix-editor>
			</div>
			<div class="mt-2">
				<button class="btn btn-pink" type="submit" data-target="group-post-creator.btn">Post to Group</button>
			</div>
		</form>
		<div class="p-4">
			{%for post in posts %}
				<div class="border border-green-200 mb-4 border-l-4">
					<div class="flex px-4 items-center">
						<p class="text-sm font-bold">{{post.user.name}}</p>
						<div data-controller="format-date" data-format-date-epoch="{{post.created}}" data-format-date-format-string="Pp" class="ml-2 italic">
							<span data-target="format-date.date" class="text-gray-700 text-xs">{{post.created | tzOffset(user.settings.timezone, "Pp")}}</span>
						</div>
					</div>
					<div class="py-2 px-4">
						{{post.body | safe}}
					</div>
				</div>
			{%else%}
				No posts in this group.
			{%endfor%}
		</div>
	</div>
{%endblock%}
{%block sidebar %}
	<div class="mt-4 border border-pink-200">
		<h3 class="text-md border-b border-pink-200 p-2 mb-2 text-gray-800 font-normal">
			About
		</h3>
		<div class="p-2 border-b-4 border-pink-400">
			{{group.description | safe}}
		</div>
	</div>
	{%endblock%}
